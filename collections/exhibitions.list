<script>

function isDateInFutureOrPast(start, end, id) {
  const today = new Date();
  const targetDiv = document.getElementById(id)
  const startDate = new Date(start)
  const endDate = new Date(end)
  console.log(start,  end)
  
var eventTypeDiv = document.getElementById("eventType-" + id)

  if (startDate > today) {
    targetDiv.classList.add("future-event")
    eventTypeDiv.innerHTML = "Upcoming"
  } else if (startDate < today && endDate > today){
    targetDiv.classList.add("current-event")
    eventTypeDiv.innerHTML = "On View"
  } else if (startDate < today) {
    targetDiv.classList.add("past-event")
    eventTypeDiv.innerHTML = "Past Event"
  }  else {
    console.log("no event defined")
  }
}
</script>

<section id="exhibitions-list">

<div class="exhibitions-panel flex-start-start">
  <h5 id="on-view-cat" class="active-cat hover" onclick="toggleSections('onview')">On View & Upcoming</h5>
  <h5 >&nbsp;/&nbsp;</h5>
  <h5 id="archive-cat" class="hover" onclick="toggleSections('archive')">Archive</h5>
</div>
<div class="flex-start-spacebetween frames-container">
  <img src="../assets/frame-decor.svg" alt="decorative frame">
  <img src="../assets/frame-decor-right.svg" alt="decorative frame">
</div>

<div id="events-list">

  {.repeated section items}
      <div class="exhibition hover fade-in" id="{id}">
          <div class="exhibition-content">
              {.if customContent.dateNotDefined}<h6><span id="eventType-{id}"></span><br><i>Check back for dates</i></h6>{.or}
              <h6 class="red-text"><span id="eventType-{id}"></span>&nbsp;&nbsp;<br> {structuredContent.startDate|date %b %d} - {structuredContent.endDate|date %B %d, %Y} </h6>
              {.end}
              <h3 onclick="window.open('{fullUrl}', '_self')">{title}</h3>
              {.if excerpt}<p>{excerpt}</p>{.end}
              <script>isDateInFutureOrPast(`{structuredContent.startDate|date %Y-%m-%dT%T}`, `{structuredContent.endDate|date %Y-%m-%dT%T}`, `{id}`)</script>
              <div class="artist-tags-wrapper flex-start-start flex-wrap">
                {.if tags}
                  {.repeated section tags}
                    <a class="artist-tag hover" href="{collection.fullUrl}?tag={@|url-encode}">{@}</a>
                  {.end}
                {.end}
              </div>
              <img src="../assets/spear.svg" alt="decorative frame" style=" margin-right: 10px;">
          </div>
      
      </div>
      
  {.end}
</div>




</section>


<script>

function toggleSections(section){
  var events = document.getElementsByClassName('exhibition')
  var eventsLength = events.length;

  var archivedEvents = document.getElementsByClassName('past-event')
  var archivedEventsLength = archivedEvents.length;

  var currentEvents = document.getElementsByClassName('current-event')
  var currentEventsLength = currentEvents.length;

  var futureEvents = document.getElementsByClassName('future-event')
  var futureEventsLength = futureEvents.length; 

  for (i=0; i < eventsLength; i++){
    events[i].classList.remove('show-event')
  }
  if (section === 'onview'){
    document.getElementById('archive-cat').classList.remove('active-cat')
    document.getElementById('on-view-cat').classList.add('active-cat')
    console.log("seen")
    for (i=0; i < currentEventsLength; i++){
      currentEvents[i].classList.add('show-event')
    }
    for (i=0; i < futureEventsLength; i++){
      futureEvents[i].classList.add('show-event')
    }
  } else {
    document.getElementById('archive-cat').classList.add('active-cat')
    document.getElementById('on-view-cat').classList.remove('active-cat')
    for (i=0; i < archivedEventsLength; i++){
      archivedEvents[i].classList.add('show-event')
    }
  }
}

toggleSections('onview')
</script>